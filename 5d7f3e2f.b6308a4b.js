(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{67:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return a})),t.d(n,"metadata",(function(){return c})),t.d(n,"rightToc",(function(){return l})),t.d(n,"default",(function(){return d}));var o=t(2),i=t(6),r=(t(0),t(86)),a={id:"configurations",title:"Network configurations"},c={unversionedId:"configurations",id:"configurations",isDocsHomePage:!1,title:"Network configurations",description:"There are two configuration files that you need to pay attention to while deploying the contract.",source:"@site/docs/configurations.md",permalink:"/configurations",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/configurations.md",sidebar:"someSidebar",previous:{title:"Usage",permalink:"/usage"}},l=[{value:"Mirror configuration",id:"mirror-configuration",children:[]},{value:"Deployment configuration",id:"deployment-configuration",children:[]}],p={rightToc:l};function d(e){var n=e.components,t=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(o.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(r.b)("p",null,"There are two configuration files that you need to pay attention to while deploying the contract."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Mirror configuration file (",Object(r.b)("inlineCode",{parentName:"li"},"mirror-config.js"),")"),Object(r.b)("li",{parentName:"ul"},"Deployment configuration file (",Object(r.b)("inlineCode",{parentName:"li"},"migration/index.js"),")")),Object(r.b)("h3",{id:"mirror-configuration"},"Mirror configuration"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"mirror-config.js")," file is similar to the ",Object(r.b)("inlineCode",{parentName:"p"},"truffle-config.js")," maintained for the Truffle tool. Just like the\ntruffle, mirror too needs the network and compilation details when the contract is being deployed. Node url, port, public key and chain Id can be maintained here. You can also maintain multiple node information here and point the mirror to the node while deploying."),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{}),"networks: {\n\n    node1: {\n      host: 'http://testnet.besu.consensolabs.com',\n      port: 20000,\n      publicKey: \"A1aVtMxLCUHmBVHXoZzzBgPbW/wj5axDpW9X8l91SGo=\",\n      chainId: 2018,\n      group: 1\n    }\n}\n")),Object(r.b)("p",null,"As you can see in the above configuration, there is also a ",Object(r.b)("inlineCode",{parentName:"p"},"group")," key for the node. This is later used in the deployment to identify all the nodes on the same group."),Object(r.b)("p",null,"You can tell the mirror about the node with ",Object(r.b)("inlineCode",{parentName:"p"},"network")," flag:"),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-bash"}),"mirror deploy --network node1\n")),Object(r.b)("h3",{id:"deployment-configuration"},"Deployment configuration"),Object(r.b)("p",null,"The configuration related to the contracts that needs to be deployed is maintained in the ",Object(r.b)("inlineCode",{parentName:"p"},"migration/index.js")," file. All the contract that needs to be deployed need to be mentioned here. If the contract has to be deployed\non a few nodes, all the node public keys has to be passed. If no private nodes are passed, it will be deployed\non all the nodes mentioned in the ",Object(r.b)("inlineCode",{parentName:"p"},"mirrir-config.js")," that mathches the group id mentioned in the migration configuration file."),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{}),"module.exports = {\n    contracts: {\n        Counter: {args: [0], privacyGroupMembers: [networks.node1.publicKey, networks.node3.publicKey]},\n    },\n    groups: {\n        public: {privacyGroupMembers: PUBLIC_NODES},\n    }\n\n};\n")),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"private")," flag will deploy on all the nodes mentioned for each contract."),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-bash"}),"mirror deploy --private\n")),Object(r.b)("h4",{id:"privacy-group-deployments"},"Privacy group deployments"),Object(r.b)("p",null,"When deploying the contract, there will be scenarios for you to deploy the contract on a set of nodes.\nIn Hyperledger Besu privacy nodes, this can be achived with privacy groups (onchain or off chain)."),Object(r.b)("p",null,"If you are deploying on privacy nodes that support onchain privacy group, you need to add an ",Object(r.b)("inlineCode",{parentName:"p"},"onchain-privacy")," flog."),Object(r.b)("pre",null,Object(r.b)("code",Object(o.a)({parentName:"pre"},{className:"language-bash"}),"mirror deploy --onchain-privacy\n")),Object(r.b)("p",null," The mirror will try to create a offchain privacy group if nothing is specified."))}d.isMDXComponent=!0}}]);