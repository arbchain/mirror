<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<title data-react-helmet="true">Network configurations | Mirror Besu</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Network configurations | Mirror Besu"><meta data-react-helmet="true" name="description" content="There are two configuration files that you need to pay attention to while deploying the contract."><meta data-react-helmet="true" property="og:description" content="There are two configuration files that you need to pay attention to while deploying the contract."><meta data-react-helmet="true" property="og:url" content="https://arbchain.github.io/configurations"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://arbchain.github.io/configurations"><link rel="stylesheet" href="/styles.66481854.css">
<link rel="preload" href="/styles.fe54381c.js" as="script">
<link rel="preload" href="/runtime~main.cf9734ee.js" as="script">
<link rel="preload" href="/main.41994b77.js" as="script">
<link rel="preload" href="/common.74e1db71.js" as="script">
<link rel="preload" href="/2.dd98d9d7.js" as="script">
<link rel="preload" href="/27.d55f5539.js" as="script">
<link rel="preload" href="/28.1e0b1d39.js" as="script">
<link rel="preload" href="/ec1ed54d.48ce4922.js" as="script">
<link rel="preload" href="/17896441.d671f733.js" as="script">
<link rel="preload" href="/5d7f3e2f.b6308a4b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Besu Mirror"><strong class="navbar__title">Besu Mirror</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/arbchain/mirror" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Besu Mirror"><strong class="navbar__title">Besu Mirror</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/arbchain/mirror" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting to know Besu Mirror</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/">Overview</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/usage">Usage</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/configurations">Network configurations</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Network configurations</h1></header><div class="markdown"><p>There are two configuration files that you need to pay attention to while deploying the contract.</p><ul><li>Mirror configuration file (<code>mirror-config.js</code>)</li><li>Deployment configuration file (<code>migration/index.js</code>)</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="mirror-configuration"></a>Mirror configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#mirror-configuration" title="Direct link to heading">#</a></h3><p>The <code>mirror-config.js</code> file is similar to the <code>truffle-config.js</code> maintained for the Truffle tool. Just like the
truffle, mirror too needs the network and compilation details when the contract is being deployed. Node url, port, public key and chain Id can be maintained here. You can also maintain multiple node information here and point the mirror to the node while deploying.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">networks: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    node1: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      host: &#x27;http://testnet.besu.consensolabs.com&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      port: 20000,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      publicKey: &quot;A1aVtMxLCUHmBVHXoZzzBgPbW/wj5axDpW9X8l91SGo=&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      chainId: 2018,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      group: 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>As you can see in the above configuration, there is also a <code>group</code> key for the node. This is later used in the deployment to identify all the nodes on the same group.</p><p>You can tell the mirror about the node with <code>network</code> flag:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">mirror deploy --network node1</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="deployment-configuration"></a>Deployment configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#deployment-configuration" title="Direct link to heading">#</a></h3><p>The configuration related to the contracts that needs to be deployed is maintained in the <code>migration/index.js</code> file. All the contract that needs to be deployed need to be mentioned here. If the contract has to be deployed
on a few nodes, all the node public keys has to be passed. If no private nodes are passed, it will be deployed
on all the nodes mentioned in the <code>mirrir-config.js</code> that mathches the group id mentioned in the migration configuration file.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module.exports = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    contracts: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Counter: {args: [0], privacyGroupMembers: [networks.node1.publicKey, networks.node3.publicKey]},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    groups: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        public: {privacyGroupMembers: PUBLIC_NODES},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div></div></div></div></div><p>The <code>private</code> flag will deploy on all the nodes mentioned for each contract.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">mirror deploy --private</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="privacy-group-deployments"></a>Privacy group deployments<a aria-hidden="true" tabindex="-1" class="hash-link" href="#privacy-group-deployments" title="Direct link to heading">#</a></h4><p>When deploying the contract, there will be scenarios for you to deploy the contract on a set of nodes.
In Hyperledger Besu privacy nodes, this can be achived with privacy groups (onchain or off chain).</p><p>If you are deploying on privacy nodes that support onchain privacy group, you need to add an <code>onchain-privacy</code> flog.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">mirror deploy --onchain-privacy</span></div></div></div></div></div><p> The mirror will try to create a offchain privacy group if nothing is specified.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/configurations.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/usage"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Usage</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#mirror-configuration" class="table-of-contents__link">Mirror configuration</a></li><li><a href="#deployment-configuration" class="table-of-contents__link">Deployment configuration</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://consensolabs.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Consenso Labs</a></li><li class="footer__item"><a href="https://twitter.com/consensolabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/arbchain/mirror" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 Consenso Labs, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.fe54381c.js"></script>
<script src="/runtime~main.cf9734ee.js"></script>
<script src="/main.41994b77.js"></script>
<script src="/common.74e1db71.js"></script>
<script src="/2.dd98d9d7.js"></script>
<script src="/27.d55f5539.js"></script>
<script src="/28.1e0b1d39.js"></script>
<script src="/ec1ed54d.48ce4922.js"></script>
<script src="/17896441.d671f733.js"></script>
<script src="/5d7f3e2f.b6308a4b.js"></script>
</body>
</html>